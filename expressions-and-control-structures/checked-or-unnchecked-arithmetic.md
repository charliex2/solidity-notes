# 算术运算的检查模式与非检查模式

在 Solidity 0.8.0 之前，算术运算总是会在发生溢出的情况下进行”截断“，从而需要引入 OpenZepplin 的 SafeMath 来解决。

从 Solidity 0.8.0 开始，所有的运算都默认会进行溢出检查，无需引入库。

unchecked 可以在 block 内部任意地方使用，但是不能替代 block。unchecked 也不能嵌套。

- unchecked 只会影响块内的语句，该块内的函数并不会继承该特性；

- 为了避免歧义，在 unchecked 块内不能使用 `_`。

- 以下运算操作符会进行溢出检查。但是如果在 unchecked 块中使用，将不会出现错误

  ```
  ++; --; +; binary -; unary -; *; /; %; **; +=; -=; *=; /=; %=
  ```

  - 除以 0 或者 除以 0 取模的异常无法被 unchecked 忽略；

- `int x = type(int).min ; -x;` 中的第二句话即溢出。因为负数的范围币正整数范围大。

- 显示转换将始终截断并不会导致失败的断言，从整数到枚举类型的转换除外；

- 比特操作并不进行上溢出、下溢出检查。例如 `<<、>>、<<==、>>==` 。举个例子 `type(uint256).max << 3` 必不会溢出错误，但是 `type(uint256).max * 8`。



